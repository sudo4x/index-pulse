# 雪球计算公式

## 成本价
 - 持股数 = ∑买入数量 + ∑红股数量 + ∑拆股所增数量 - ∑卖出数量 - ∑合股所减数量
 - 摊薄成本 = (∑买入金额 - ∑卖出金额 - ∑现金股息) / 持股数
 - 持仓成本 = ∑买入金额 / (∑买入数量 + ∑红股数量 + ∑拆股所增数量 - ∑合股所减数量)

## 浮动盈亏
 - 浮动盈亏额 ＝ (当前价 - 持仓成本) * 多仓持股数
 - 浮动盈亏率 ＝ 浮动盈亏额 / (持仓成本价 * 持股数)
 - 分市场浮动盈亏额 ＝ ∑个股浮动盈亏额
 - 分市场浮动盈亏率 ＝ 分市场浮动盈亏额 / ∑(个股持仓成本 * 个股持股数)

## 累计盈亏
 - 个股累计盈亏额 ＝ 多仓市值 - ∑买入金额 + ∑卖出金额 + ∑现金股息
 - 个股累计盈亏率 ＝ 累计盈亏额 / ∑买入金额
 - 分市场累计盈亏额 ＝ ∑个股累计盈亏额
 - 分市场累计盈亏率(无银转) ＝ 累计盈亏额 / ∑个股买入金额
 - 有银转分市场累计盈亏率(有银转) = 累计盈亏额 / ∑转入金额

## 当日盈亏

### 昨日市值 > 0
 - 当日盈亏额 = (现市值 - 昨收市值 + 当日∑卖出 - 当日∑买入)
 - 当日盈亏率 = 当日盈亏额 / (昨市值 + 当日∑买入 + 当日∑卖空)

### 昨日市值 = 0
 - 当日盈亏额 = (现价 - 持仓成本) * 股数 + 当日∑卖出 - 当日∑买入
 - 当日盈亏率 = 当日盈亏额 / 当日∑买入