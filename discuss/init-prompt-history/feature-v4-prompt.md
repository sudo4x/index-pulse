## 交易中佣金和税费相关功能优化

### 优化动机

五种交易类型中，买入和卖出两种类型都有佣金和税费的输入项，除权除息有税费的输入项。
目前佣金和税费的填入分散到每次的交易记录中手动填写，太麻烦了。佣金和税费是有固定算法可以通过现有条件计算出来的。
所以我只要有统一的地方来保存佣金的每笔最低收取金额和佣金率，就可以通过计算算法算出佣金。印花税和过户费因为比例固定所以不用单独保存。

### 佣金计算算法

买卖双向收取，每笔最低X元起，超过按佣金率收取。

### 印花税计算算法

- 卖出时收取，按成交金额的0.05%计算
- 需要注意：个股卖出时需要收取，ETF不收取
- 个股和ETF可以通过代码区别判断
  ```
  A股​：ETF（51/15/588开头） vs 个股（60/00/30/688/8开头）
  ​港股​：ETF（03/08开头） vs 个股（5位数字）
  ```

### 过户费计算算法(只有个股收过户费，ETF不收取)

```
​交易所​	​是否单独收过户费​	​收取方​	​费率标准​
沪市（60/68开头）	✅ 是	中登公司	成交金额的0.01‰（双向）
深市（00/30开头）	❌ 否	无单独费用	已包含在经手费中
```

### 具体优化设计

#### 佣金的每笔最低收取金额和佣金率的保存位置

- 新增组合时，除了组合名称还需要增加两个输入变量，佣金最低金额和佣金率
- 组合管理 功能里的 组合编辑也要支持两个新增变量的编辑功能
- 删除 买入，卖出交易方式下交易对话框的佣金和税费两个输入项
- 除权除息保留税费输入项，只需要支持金额的填入即可

#### 数据结构和交易记录计算方式

- 交易记录表需要新增 过户费 字段
- 交易记录表需要新增说明字段 description，用于备注并记录 税费 佣金和过户费的发生金额
- 相关盈亏计算算法里面需要考虑税费 佣金和过户费
- 交易记录表以下4个字段需要重新设计，只需要保留佣金和税费金额字段

```
    commission: decimal("commission", { precision: 18, scale: 2 }).default("0"), // 佣金
    commissionRate: decimal("commission_rate", { precision: 8, scale: 6 }), // 佣金费率 (千分比)
    tax: decimal("tax", { precision: 18, scale: 2 }).default("0"), // 税费
    taxRate: decimal("tax_rate", { precision: 8, scale: 6 }), // 税费费率 (千分比)
```

### 以下是后续修复补充的prompt

- 数据库未完成升级报错了
- PortfolioCreateDialog 需要优化一下：
  1.  输入项三列布局太挤了，改成两行布局，名称为一行，最低佣金，佣金率为一行，名称需要注意占满宽度 (这个又交互了3次才改对)
  2.  现在这个组件支持创建，需要改成同时支持创建和编辑。管理组合那边新增一个编辑按钮，可以打开这个对话框对组合的完整信息进行编辑，需要注意，组合管理那边名称的快捷需改需要保留 -我 看到lint有不少 复杂度太高的error，你仔细查看并思考，好好重构解决一下，注意不能修改原有功能
