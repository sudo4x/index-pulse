
# 历史持仓改造

## 仓位周期管理器 
相关代码 @src/lib/services/position-cycle-manager.ts
这个仓位周期管理的代码之前是为了计算累计盈亏加上的，现在累计盈亏这个概念已经去掉了，所以这部分代码目前是不需要的需要去掉。
同时transactions表中的positionCycleId字段也要删除掉，相关的代码也要一并检查并删除

去掉仓位管理周期相关代码后需要检查下以下逻辑是否满足：
1、holdings表中的isActive的更新逻辑是：如果一个品种清仓，那么这个字段变成false，如果重新买入建仓，那么是新增一个新的holding记录，isActive字段是true。transactions记录只需要和holdings表的ID关联就可以。
2、持仓品种列表接口 的逻辑是获取isActive为true的记录
3、已清仓品种列表接口 的逻辑是获取isActive为false的记录


## UI改造
目前是在持仓Tab下有一个“显示历史持仓”的checkbox，点击会显示历史持仓品种。
现在要改造成把历史持仓的品种列表单独出来变成一个独立的tab，叫 "已清仓"。
相关代码在@src/app/(main)/investment/portfolios/_components/holdings-table-container.tsx



## 其他注意点
以上的改动可能会影响一些其他已有功能，你需要深度思考一下有哪些影响，逐一分析，列出改造的细节。

